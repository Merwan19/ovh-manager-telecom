<section class="telephony-group-line-consumption-incoming-calls">

    <header>
        <section-back-link section-back-link-to-state="telecom.telephony.line.consumption"
                           section-back-link-title="{{:: 'telephony_line_consumption_back_link' | translate }}">
        </section-back-link>
        <h1 data-translate="telephony_line_management_actions_line_consumption_incoming_fax"></h1>
    </header>

    <div class="telecom-section-content">
        <div class="widget-presentation">
            <h2 class="widget-presentation-title"
                data-translate="telephony_line_consumption_incoming_fax_all"></h2>
        </div>
        <div class="row">
            <div class="col-sm-6">
                <div data-translate="telephony_line_consumption_incoming_fax_period"
                     data-translate-values="{ start: IncomingFaxCtrl.period.start.format('DD/MM/YYYY'),
                                              end: IncomingFaxCtrl.period.end.format('DD/MM/YYYY') }">
                </div>
                <div data-ng-if="IncomingFaxCtrl.consumption.raw.length"
                     data-translate="telephony_line_consumption_incoming_fax_summary"
                     data-translate-values="{ fax: IncomingFaxCtrl.consumption.raw.length,
                                              pages: IncomingFaxCtrl.consumption.pagesSum }">
                </div>
            </div>
        </div>
        <div class="row" data-ng-if="IncomingFaxCtrl.consumption.raw.length">
            <div class="col-xs-12">
                <button class="btn btn-sm btn-default no-outline pull-right"
                        type="button"
                        data-ng-click="IncomingFaxCtrl.toggleShowFilter()">
                    <i data-ng-if="!IncomingFaxCtrl.consumption.showFilter" class="ovh-font ovh-font-search"></i>
                    <i data-ng-if="IncomingFaxCtrl.consumption.showFilter" class="ovh-font ovh-font-wrong"></i>
                    <span class="left-space-m4" data-translate="common_search"></span>
                </button>
            </div>
        </div>
        <div class="top-space-m8" data-ng-if="IncomingFaxCtrl.consumption.showFilter">
            <div flat-input-container class="pull-right right-space-m4 telephony-consumption-filter-input">
                <div class="input-group">
                    <span class="input-group-addon">
                        <i class="ovh-font ovh-font-phone fs16"></i>
                    </span>
                    <input class="form-control"
                           type="text"
                           data-ng-model="IncomingFaxCtrl.consumption.filterBy.calling"
                           data-ng-change="IncomingFaxCtrl.applySorting()"
                           placeholder="{{:: 'telephony_line_consumption_calling' | translate }}"
                           autofocus />
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12 table-responsive-vertical top-space-m4">
                <table class="table table-pretty table-hover table-striped no-space">
                    <thead>
                        <tr>
                            <th>
                                <button class="no-style no-outline left-space-p0"
                                        type="button"
                                        data-ng-disabled="!IncomingFaxCtrl.consumption.paginated.length"
                                        data-ng-click="IncomingFaxCtrl.orderBy('creationDatetime')">
                                    <label class="pointer" data-translate="telephony_line_consumption_date"></label>
                                    <span class="table-pretty-filter">
                                        <i class="fa" data-ng-class="{
                                            'fa-sort': IncomingFaxCtrl.consumption.orderBy !== 'creationDatetime',
                                            'fa-sort-desc': IncomingFaxCtrl.consumption.orderBy === 'creationDatetime' && IncomingFaxCtrl.consumption.orderDesc,
                                            'fa-sort-asc': IncomingFaxCtrl.consumption.orderBy === 'creationDatetime' && !IncomingFaxCtrl.consumption.orderDesc
                                        }"></i>
                                    </span>
                                </button>
                            </th>
                            <th>
                                <button class="no-style no-outline left-space-p0"
                                        type="button"
                                        data-ng-disabled="!IncomingFaxCtrl.consumption.paginated.length"
                                        data-ng-click="IncomingFaxCtrl.orderBy('calling')">
                                    <label class="pointer" data-translate="telephony_line_consumption_calling"></label>
                                    <span class="table-pretty-filter">
                                        <i class="fa" data-ng-class="{
                                            'fa-sort': IncomingFaxCtrl.consumption.orderBy !== 'calling',
                                            'fa-sort-desc': IncomingFaxCtrl.consumption.orderBy === 'calling' && IncomingFaxCtrl.consumption.orderDesc,
                                            'fa-sort-asc': IncomingFaxCtrl.consumption.orderBy === 'calling' && !IncomingFaxCtrl.consumption.orderDesc
                                        }"></i>
                                    </span>
                                </button>
                            </th>
                            <th>
                                <button class="no-style no-outline left-space-p0"
                                        type="button"
                                        data-ng-disabled="!IncomingFaxCtrl.consumption.paginated.length"
                                        data-ng-click="IncomingFaxCtrl.orderBy('pages')">
                                    <label class="pointer" data-translate="telephony_line_consumption_incoming_fax_pages"></label>
                                    <span class="table-pretty-filter">
                                        <i class="fa" data-ng-class="{
                                            'fa-sort': IncomingFaxCtrl.consumption.orderBy !== 'pages',
                                            'fa-sort-desc': IncomingFaxCtrl.consumption.orderBy === 'pages' && IncomingFaxCtrl.consumption.orderDesc,
                                            'fa-sort-asc': IncomingFaxCtrl.consumption.orderBy === 'pages' && !IncomingFaxCtrl.consumption.orderDesc
                                        }"></i>
                                    </span>
                                </button>
                            </th>
                            <th>
                                <button class="no-style no-outline left-space-p0"
                                        type="button"
                                        data-ng-disabled="!IncomingFaxCtrl.consumption.paginated.length"
                                        data-ng-click="IncomingFaxCtrl.orderBy('wayType')">
                                    <label class="pointer" data-translate="telephony_line_consumption_type"></label>
                                    <span class="table-pretty-filter">
                                        <i class="fa" data-ng-class="{
                                            'fa-sort': IncomingFaxCtrl.consumption.orderBy !== 'wayType',
                                            'fa-sort-desc': IncomingFaxCtrl.consumption.orderBy === 'wayType' && IncomingFaxCtrl.consumption.orderDesc,
                                            'fa-sort-asc': IncomingFaxCtrl.consumption.orderBy === 'wayType' && !IncomingFaxCtrl.consumption.orderDesc
                                        }"></i>
                                    </span>
                                </button>
                                <button class="no-style no-outline left-space-p0 left-space-m8"
                                        type="button"
                                        data-ng-disabled="IncomingFaxCtrl.consumption.isLoading"
                                        data-ng-click="IncomingFaxCtrl.refresh()">
                                    <i class="fa fa-refresh"></i>
                                </button>
                            </th>
                        </tr>
                    </thead>
                    <tbody data-ng-if="!IncomingFaxCtrl.consumption.isLoading">
                        <tr data-ng-repeat="conso in IncomingFaxCtrl.consumption.paginated | orderBy:IncomingFaxCtrl.order.by:IncomingFaxCtrl.order.reverse">
                            <td data-title="{{:: 'telephony_line_consumption_date' | translate }}">
                                <span class="text-nowrap right-space-m16" data-ng-bind="::conso.creationDatetime | date: 'dd/MM/yyyy'"></span>
                                <span class="text-nowrap right-space-m16" data-ng-bind="::conso.creationDatetime | date: 'HH:mm:ss'"></span>
                            </td>
                            <td data-title="{{:: 'telephony_line_consumption_calling' | translate }}">
                                <span class="text-nowrap" data-ng-if="conso.calling" data-ng-bind="::conso.calling | phoneNumber"></span>
                                <span class="text-nowrap" data-ng-if="!conso.calling" data-translate="telephony_line_consumption_calling_unknown"></span>
                            </td>
                            <td data-title="{{:: 'telephony_line_consumption_incoming_fax_pages' | translate }}">
                                <span class="text-nowrap" data-ng-bind="::conso.pages"></span>
                            </td>
                            <td data-title="{{:: 'telephony_line_consumption_type' | translate }}">
                                <span class="text-nowrap" data-ng-bind="::'telephony_line_consumption_type_' + conso.wayType | translate"></span>
                            </td>
                        </tr>
                    </tbody>
                    <tbody data-ng-if="IncomingFaxCtrl.consumption.isLoading">
                        <tr>
                            <td class="text-center top-space-p16 bottom-space-p16" colspan="4">
                                <spinner class="left-space-m4"></spinner>
                            </td>
                        </tr>
                    </tbody>
                    <tbody data-ng-if="!IncomingFaxCtrl.consumption.isLoading && !IncomingFaxCtrl.consumption.raw.length">
                        <tr>
                            <td class="text-center top-space-p16 bottom-space-p16" colspan="4">
                                <span data-translate="telephony_line_consumption_incoming_fax_empty"></span>
                            </td>
                        </tr>
                    </tbody>
                    <tbody data-ng-if="!IncomingFaxCtrl.consumption.isLoading &&
                                       IncomingFaxCtrl.consumption.raw.length &&
                                       !IncomingFaxCtrl.consumption.paginated.length">
                        <tr>
                            <td class="text-center top-space-p16 bottom-space-p16" colspan="4">
                                <span data-translate="telephony_line_consumption_incoming_fax_not_found"></span>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <div class="table-pretty-pagination top-space-m8"
                     data-ng-if="!IncomingFaxCtrl.consumption.isLoading && IncomingFaxCtrl.consumption.raw.length"
                     data-pagination-front
                     data-items="IncomingFaxCtrl.consumption.sorted"
                     data-paginated-items="IncomingFaxCtrl.consumption.paginated"
                     data-current-page="currentPage"
                     data-nb-pages="nbPages"
                     data-items-per-page="itemsPerPage"
                     data-page-placeholder="{{'common_pagination_page' | translate: {currentPage:currentPage, nbPages:nbPages} }}"
                     data-item-per-page-placeholder="{{'common_pagination_display' | translate}}">
                </div>
            </div>
        </div>

    </div>

</section>
