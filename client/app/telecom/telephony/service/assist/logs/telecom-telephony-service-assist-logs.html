<div class="telecom-telephony-service-assist-logs">

    <bouncing-box-loader data-ng-if="LogsCtrl.loading.init">
        <h2 data-translate="loading"></h2>
    </bouncing-box-loader>

    <div data-ng-if="!LogsCtrl.loading.init">
        <header>
            <section-back-link section-back-link-to-state="{{ LogsCtrl.service.isFax ? 'telecom.telephony.fax.assist' : 'telecom.telephony.line.assist' }}"
                               section-back-link-title="{{ 'telephony_service_assist_support_logs_title' | translate }}">
            </section-back-link>
            <h1 data-translate="telephony_line_assist_support_logs_title"></h1>
        </header>

        <div class="telecom-section-content">

            <toast-message></toast-message>

            <div class="alert alert-info"
                 role="alert"
                 data-translate="telephony_line_assist_support_logs_infos">
            </div>

            <div class="row">

                <section class="col-xs-12 col-sm-6 widget-presentation">
                    <header class="widget-presentation-header">
                        <h2 class="widget-presentation-title"
                            data-translate="telephony_line_assist_support_logs_configs">
                        </h2>
                    </header>
                    <bouncing-box-loader data-ng-if="LogsCtrl.loading.user || LogsCtrl.loading.save"
                                         data-size="m">
                        <h2 data-translate="{{ LogsCtrl.loading.user ? 'loading' : 'telephony_line_assist_support_logs_configs_save' }}"></h2>
                    </bouncing-box-loader>
                    <div data-ng-if="!LogsCtrl.model.configEdit">
                        <dl>
                            <dt data-translate="telephony_line_assist_support_logs_configs_frequency"></dt>
                            <dd data-translate="{{ LogsCtrl.service.notifications.logs ? (['telephony_line_assist_support_logs_configs_frequency', LogsCtrl.service.notifications.logs.frequency].join('_') | snakeCase) : 'telephony_line_assist_support_logs_configs_frequency_never' }}"></dd>

                            <dt data-translate="telephony_line_assist_support_logs_configs_send_even_no_logs"
                                data-ng-if="LogsCtrl.service.notifications.logs.frequency !== 'Never'">
                            </dt>
                            <dd data-translate="{{ LogsCtrl.service.notifications.logs.sendIfNull ? 'telephony_line_assist_support_logs_configs_send_even_no_logs_yes' : 'telephony_line_assist_support_logs_configs_send_even_no_logs_no' }}"
                                data-ng-if="LogsCtrl.service.notifications.logs.frequency !== 'Never'">
                            </dd>

                            <dt data-translate="telephony_line_assist_support_logs_configs_email"
                                data-ng-if="LogsCtrl.service.notifications.logs.frequency !== 'Never'">
                            </dt>
                            <dd data-ng-bind="LogsCtrl.service.notifications.logs.email"
                                data-ng-if="LogsCtrl.service.notifications.logs.frequency !== 'Never'">
                            </dd>
                        </dl>
                        <button class="btn btn-primary"
                                type="button"
                                data-ng-click="LogsCtrl.startNotificationsChange()"
                                data-translate="telephony_line_assist_support_logs_configs_manage">
                        </button>
                    </div>
                    <form name="notificationEditForm"
                          novalidate
                          data-ng-if="LogsCtrl.model.configEdit && !LogsCtrl.loading.user && !LogsCtrl.loading.save"
                          data-ng-submit="LogsCtrl.saveLogsNotifications()">

                        <!-- FREQUENCY -->
                        <div class="form-group">
                            <label for="frequency-select"
                                   class="control-label"
                                   data-translate="telephony_line_assist_support_logs_configs_frequency">
                            </label>
                            <select class="form-control"
                                    id="frequency-select"
                                    name="frequency"
                                    data-ng-model="LogsCtrl.service.notifications.logs.frequency"
                                    data-ng-options="frequency as (['telephony_line_assist_support_logs_configs_frequency', frequency].join('_') | snakeCase | translate ) for frequency in LogsCtrl.availableLogsFrequencies">
                            </select>
                        </div> <!-- FREQUENCY -->

                        <!-- SENDIFNULL -->
                        <div class="form-group clearfix"
                             data-ng-if="LogsCtrl.service.notifications.logs.frequency !== 'Never'">
                            <label class="control-label"
                                   data-translate="telephony_line_assist_support_logs_configs_send_even_no_logs">
                            </label>
                            <div class="btn-group d-block">
                                <label class="btn btn-default"
                                       data-ng-model="LogsCtrl.service.notifications.logs.sendIfNull"
                                       data-uib-btn-radio="true"
                                       data-translate="telephony_line_assist_support_logs_configs_send_even_no_logs_yes">
                                </label>

                                <label class="btn btn-default"
                                       data-ng-model="LogsCtrl.service.notifications.logs.sendIfNull"
                                       data-uib-btn-radio="false"
                                       data-translate="telephony_line_assist_support_logs_configs_send_even_no_logs_no">
                                </label>
                            </div>
                        </div> <!-- SENDIFNULL -->

                        <!-- EMAIL -->
                        <div class="form-group"
                             data-ng-if="LogsCtrl.service.notifications.logs.frequency !== 'Never'"
                             data-ng-class="{
                                'has-error': notificationEditForm.email.$touched && notificationEditForm.email.$invalid
                             }">
                            <label for="email-input"
                                   class="control-label"
                                   data-translate="telephony_line_assist_support_logs_configs_email">
                            </label>
                            <input type="email"
                                   id="email-input"
                                   name="email"
                                   class="form-control"
                                   data-translate-attr="{ placeholder: 'telephony_line_assist_support_logs_configs_email' }"
                                   data-ng-model="LogsCtrl.service.notifications.logs.email"
                                   data-ng-required="LogsCtrl.service.notifications.logs.frequency !== 'Never'"/>
                            <span class="help-block"
                                  role="alert"
                                  data-ng-if="notificationEditForm.email.$touched"
                                  data-ng-messages="notificationEditForm.email.$error">
                                <span data-ng-message="email"
                                      data-translate="telephony_line_assist_support_logs_configs_email_invalid">
                                </span>
                                <span data-ng-message="required"
                                      data-translate="telephony_line_assist_support_logs_configs_email_required">
                                </span>
                            </span>
                        </div> <!-- EMAIL -->

                        <div class="form-group">
                            <button type="submit"
                                    class="btn btn-primary"
                                    data-ng-disabled="notificationEditForm.$pristine || notificationEditForm.$invalid"
                                    data-translate="telephony_line_assist_support_logs_configs_validate">
                            </button>
                            <button type="button"
                                    class="btn btn-default"
                                    data-translate="cancel"
                                    data-ng-click="LogsCtrl.cancelNotificationsChange()">
                            </button>
                        </div>
                    </form>
                </section>
                <!-- /.widget-presentation -->

                <section class="col-xs-12 col-sm-6 widget-presentation">

                    <header class="widget-presentation-header">
                        <h2 class="widget-presentation-title"
                            data-translate="telephony_line_assist_support_logs_list">
                        </h2>
                    </header>

                    <form name="consultDayForm">
                        <div class="form-group">
                            <label for="dayInterval-select"
                                   class="control-label"
                                   data-translate="telephony_line_assist_support_logs_list_days">
                            </label>
                            <select class="form-control"
                                    id="dayInterval-select"
                                    name="dayInterval"
                                    data-ng-model="LogsCtrl.model.dayInterval"
                                    data-ng-change="LogsCtrl.refreshLogs()"
                                    data-ng-options="dayInterval as (['telephony_line_assist_support_logs_list_days', dayInterval].join('_') | snakeCase | translate ) for dayInterval in LogsCtrl.availableDayInterval">
                            </select>
                        </div>
                    </form>

                    <bouncing-box-loader data-ng-if="LogsCtrl.loading.refresh"
                                         data-size="m">
                        <h2 data-translate="telephony_line_assist_support_logs_list_loading"></h2>
                    </bouncing-box-loader>

                    <div data-ng-if="!LogsCtrl.loading.refresh">

                        <em class="d-block text-center"
                            data-ng-if="LogsCtrl.logs.length === 0"
                            data-translate="telephony_line_assist_support_logs_list_no_logs">
                        </em>

                        <div data-ng-if="LogsCtrl.logs.length > 0">
                            <div class="logs-list">
                                <div class="media"
                                     data-ng-repeat="log in LogsCtrl.pageLogs track by $index">
                                    <div class="media-left">
                                        <i data-ng-class="{
                                                'ovh-font ovh-font-filled-warning text-warning': log.level === 'warn',
                                                'ovh-font ovh-font-filled-error text-danger': log.level === 'error',
                                                'ovh-font ovh-font-filled-info text-info': log.level === 'info',
                                                'fa fa-bug text-info': log.level === 'debug'
                                           }">
                                        </i>
                                    </div>
                                    <div class="media-body">
                                        <h4 class="media-heading"
                                            data-ng-bind="log.name | words:'true'">
                                        </h4>
                                        <p class="text-muted"
                                           data-ng-bind="log.datetime | date:'short'">
                                        </p>
                                        <p class="text-muted">
                                            <span data-ng-bind="log.report"></span><br>
                                            <span data-ng-bind="log.description"></span>
                                        </p>
                                    </div>
                                </div>
                            </div>
                            <div class="mt-3 text-left"
                                 data-ng-show="LogsCtrl.logs.length > LogsCtrl.logsPerPage"
                                 data-ng-init="logsPerPage = LogsCtrl.logsPerPage"
                                 data-pagination-front
                                 data-items="LogsCtrl.logs"
                                 data-paginated-items="LogsCtrl.pageLogs"
                                 data-current-page="currentPage"
                                 data-nb-pages="nbPages"
                                 data-items-per-page="logsPerPage"
                                 data-go-to-page="false">
                            </div>
                        </div>

                    </div>

                </section>
                <!-- /.widget-presentation -->

            </div>

        </div>
        <!-- /.telecom-section-content -->

    </div>

</div>
<!-- /.telecom-telephony-service-assist-logs -->
